<template>
    <div  id="allScans" >
        <tool-header>
            <h4>All Scans</h4>
        </tool-header>

        <v-client-table
        :data='table_data'
        :columns='columns'
        :options='options'
        >

        <a  slot="download" 
            slot-scope="props"
            :href="props.row.uri"
        >
           <i class="fa fa-download"></i>
        </a>

        </v-client-table>

    </div>
</template>

<script>
import ToolHeader from "../comps_forEach_tool/ToolHeader.vue";

export default {
  components: {
    ToolHeader
  },
  created() {
    axios
      .get("allscans")
      .then(response => {
        //this adapts response for show in vue tables 2
        response.data.data.forEach(scan_info => {
          this.table_data.push({
            date: moment(scan_info.created_at),
            scan: scan_info.scanName,
            output: "",
            uri: scan_info.path
          });
        });
      })
      .catch(err => {
        console.log(err);
      });
  },
  data() {
    return {
      user_token: "",
      columns: ["date", "scan", "download"],

      table_data: [],
      options: {
        columnsClasses: {
          date: "cursorable"
        },
        datepickerOptions: {
          linkedCalendars: true
        },
        sortable: ["date"],
        filterable: ["date", "scan"],
        dateColumns: ["date"],
        filterByColumn: true,
        pagination: {
          dropdown: true,
          nav: "scroll"
        },
        dateFormat: "DD/MM/YYYY"
      }
    };
  }
};
</script>

<style scoped>
/*deep select certain class*/
body >>> .dropdown-menu {
  width: 13rem;
}

#allScans >>> .VueTables__date-filter-wrapper {
  cursor: pointer;
  cursor: hand;
}
#allScans >>> .VueTables__sortable {
  cursor: pointer;
  cursor: hand;
}
#allScans >>> .VueTables__dropdown-pagination {
  display: block;
}
</style>
