<template>
  <div class="pricing">

    <div class="header">
        <h4>{{info.title}}</h4>
    </div>
    
    <div class="oneTime">
        <h4>One Time</h4>
        <p>{{info.onetime}}</p>
    </div>


    <div class="yearly">
        <h4 v-if="!info.free">Yearly</h4>
        <h4 v-else>Available</h4>
        
        <p class="text-muted">{{info.yearly}}</p>
    </div>
    
    <!-- show if not subscribed -->
    <b-button v-if="!subscribed" id="btn" class="btn btn-info" @click="clickedPackage()">
        Get package! 
    </b-button>

    <!-- show if subscribed -->
    <b-button v-if="subscribed" id="btn" class="btn btn-info" @click="cancelPackage()">
        Unsubscribe!
    </b-button>
    
</div>
</template>

<script>
import eventBus from '../../eventBus';

export default {
    data(){
        return{
            subscribed:false,
            title:this.info.title
        }
    },
    mounted(){
        eventBus.$on("subscribed",(title)=>{
            
            let package_match = title === this.info.title;

            if(package_match)
            {
                this.subscribed = true;                
                let plan = document.querySelector('.subscription');
                plan.innerHTML = `${title} plan`;
            }   
            else
                this.subscribed = false;
            
            })
    },
    methods:{
        clickedPackage(){
            eventBus.$emit("packageSelected",this.title.toLowerCase())
        },
        cancelPackage(){
            axios.get("/cancel");
        }

    },
   props:{
       info:{
           type:Object
       }
   }
  
}
</script>

<style scoped>
#btn{
    margin-left: 0;
}
.pricing{
    width:fit-content;
    padding: 20px;
    text-align: center;
    margin-right: 25px;
    box-shadow: 1px 1px 1px 1px #ddd;
}
.pricing h4 {
    padding: 10px 0;
}
.pricing:first-of-type {
        border-top: 3px solid #3b2fda;
}
.pricing:nth-child(2) {
     border-top: 3px solid #29c74c;
}
.pricing:nth-child(3) {
      border-top: 3px solid #c7294c;
} 
.pricing:last-of-type {
      border-top: 3px solid #ecfb1f;
}
.header{
    border-bottom: 1px solid rgb(206, 205, 209);
    margin-bottom: 5%;
}


</style>
