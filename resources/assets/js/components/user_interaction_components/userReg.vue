<template>
    <div id="loginContainer" class="container-fluid">
      
      <app-form :options.sync="logForm" :regForm="reg"></app-form>
      
    </div>
</template>


<script>
import appForm from "../form_comps/appForm.vue";
import { SnotifyPosition, SnotifyStyle } from "vue-snotify";

export default {
  components: {
    appForm
  },
  data() {
    let vm = this;
    return {
      reg: true,
      logForm: {
        axiosSubmitForm() {
          axios
            .post("/userRegister", {
              email: vm.logForm.inputs.email.value,
              password: vm.logForm.inputs.pw.value,
              sameaspw: vm.logForm.inputs.pwagain.value,
              firstname: vm.logForm.inputs.firstname.value,
              lastname: vm.logForm.inputs.lastname.value
            })
            .then(function(response) {

                if(response.data === "This mail already exist")
                { 
                  vm.$snotify.error("User exists!", "Error!", {
                    position: SnotifyPosition.centerTop,
                    backdrop: 0.5
                  });

                  return;
                }
                else if (response.status === 200) {

                  window.setTimeout (() => {
                    window.location.href = "/";
                  }) 
                  return;
                }
              
            })
            .catch((response) => {

                vm.$snotify.error("An error has occured.", "Error", {
                  position: SnotifyPosition.centerTop,
                  backdrop: 0.5
                });

                window.setTimeout(()=>{
                  window.location.reload();
                },1500);
              }
            );
        },
        inputs: {
          email: {
            type: "text",
            id: "email",
            label: "e-mail address",
            value: "",
            validation: {
              required: true
            }
          },
          pw: {
            type: "password",
            id: "password",
            label: "password",
            value: "",
            validation: {
              required: true
            }
          },
          pwagain: {
            type: "password",
            id: "sameaspw",
            value: "",
            label: "repeat password",
            validation: {
              required: true
            }
          },
          firstname: {
            type: "text",
            id: "firstname",
            label: "Name",
            value: "",
            validation: {
              required: true
            }
          },
          lastname: {
            type: "text",
            id: "lastname",
            label: "Last Name",
            value: "",
            validation: {
              required: true
            }
          }
        },
        recaptchaToken: undefined
      }
    };
  },
  methods: {
    onCaptchaVerified() {}
  }
};
</script>


<style scoped>
#loginContainer {
  background-image: url("/images/log_reg.jpg");
  background-attachment: fixed;
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
  width: 100vw;
  height: 110vh;
  margin-left: -32px;
}

h4 {
  text-align: center;
}
</style>
