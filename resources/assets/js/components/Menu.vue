<template>
    
    <b-navbar toggleable="md" v-if="isVisible" >
     
        <b-navbar-toggle target="nav_collapse" id="collapse_toggler">
            <icon class="toggler" name="expand"> </icon>
            <span>All tools</span>
        </b-navbar-toggle>

        <b-collapse is-nav id="nav_collapse">

            <b-nav  pills  v-if="isVisible" class="center_nav">
                
                    <b-nav-item-dropdown class="my_dropdown" text="Information Gathering">
                        
                        
                            
                            <b-dropdown-item  v-for="item in Tools.ethHackSub" :key="item.title" >
                                <router-link :to="item.relPath">

                                    {{item.title}}
                                
                                </router-link>
                            </b-dropdown-item>

                    

                    </b-nav-item-dropdown>

                    
                    <b-nav-item-dropdown text="Web Application Testing">
                        
                        <b-dropdown-item 
                        v-for="item in Tools.webAppTestSub" 
                        :key="item.title">
                        
                            <router-link :to="item.relPath"> {{item.title}}</router-link>
                    
                        </b-dropdown-item>
                    

                    </b-nav-item-dropdown>

                    
                    <b-nav-item-dropdown 
                    text="Infrastructure Testing">
                        
                        <b-dropdown-item 
                        v-for="item in Tools.infTestSub" 
                        :key="item.title">
                        
                            <router-link :to="item.relPath"> {{item.title}}</router-link>
                    
                        </b-dropdown-item>
                        
                    

                    </b-nav-item-dropdown>

                    
                    <b-nav-item-dropdown text="Utils">
                        
                        <b-dropdown-item 
                        v-for="item in Tools.utilSub" 
                        :key="item.title">
                        
                            <router-link :to="item.relPath"> {{item.title}}</router-link>
                    
                        </b-dropdown-item>
                    

                    </b-nav-item-dropdown>
            </b-nav>
            
            
        </b-collapse>
        
    </b-navbar>
</template>

<script>
import Tools from "../tools";
import eventBus from "../eventBus";
import "vue-awesome/icons/expand";

import Icon from "vue-awesome/components/Icon";

export default {
  components: {
    Icon
  },
  mounted() {
    //FROM SOME TOOLS THE MENU DOESN'T CHANGE CLASSES:...

    //REMOVE ROW TO FIX THE OVERFLOW X ON MENU_TOOLS

    // let nav = document.querySelector("nav");
    // console.log(nav);

    // let str = nav.className;
    // str.replace("row","");
    // nav.className = str;

    let routes_to_disable = [
      "/userreg",
      "/userlogin",
      "/contact",
      "/pricing",
      "/home",
      "/tools",
      "/all-scans",
      "/resetpw",
      "/forgotpw"
    ];
    let my_current_path = this._routerRoot._route.path;

    let header = document.getElementById("header_navbar");

    // header.className += " header_tools"

    // let menu_visible = !routes_to_disable.includes(
    //   this.$parent._routerRoot._route.path
    // );

    // if (menu_visible) {
    //   this.isVisible = true;
    //   header.className += " header_tools";
    // } else {
    //   READ
    //   let classes_of_header = header.className;

    //   MOD
    //   if (classes_of_header.includes("header_tools")) {
    //     let len = "header_tools".length;
    //     classes_of_header = classes_of_header.slice(0, -len);
    //   }

    //   WRITE
    //   header.className = classes_of_header;
    // }

    eventBus.$on("isVisibleSidebar", value => {
        this.isVisible = value;

        if(value === true)
            header.className += " header_tools";
        else
        {

            //READ
            let classes_of_header =  header.className;

            //MOD
            if(classes_of_header.includes("header_tools"))
            {
                let len = "header_tools".length;
                classes_of_header = classes_of_header.slice(0,-len);
            }

            //WRITE
            header.className = classes_of_header;
            
            console.group("Main vue delete header tools");
            console.log("on visible sidebar");
            console.log(value);
            console.log(classes_of_header);
            console.groupEnd();
        }

    });
  },
  data() {
    return {
      isVisible: false,
      Tools,
      footerSlot: false,
      iconSlot: false
    };
  }
};
</script>

<style scoped>
#collapse_toggler > span {
  vertical-align: top;
  color: black;
}

.toggler {
  color: black;
}

.center_nav >>> .dropdown-menu {
  width: fit-content;
  padding: 0;
  left: 0;
}

.dropdown-menu a {
  width: fit-content;
  padding: 0;
  background-color: transparent;
  outline: none;
  padding: 0.5rem;
}

a:hover {
  text-decoration: none;
  background-color: transparent;
  outline: none;
}

.center_nav {
  margin-left: auto;
  margin-right: auto;
}
.my_navbar {
  background-color: rgba(19, 23, 33, 0.7);
}

.my_dropdown {
  color: antiquewhite;
}
</style>
